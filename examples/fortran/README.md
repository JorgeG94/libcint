# Fortran Examples for libcint

This directory contains Fortran examples demonstrating how to use libcint from Fortran code.

Transparency: This doc was generated by an LLM but carefully read and edited by a human. 

## Quick Start

libcint provides **two Fortran interface modules** (located in `include/`, compiled with the library):

1. **`libcint_interface`** - Low-level C binding using `iso_c_binding`
   - Use when you need maximum control and don't mind C types
   - Types: `integer(c_int)`, `real(c_double)`, `complex(c_double_complex)`

2. **`libcint_fortran`** - High-level pure Fortran API
   - Types: `integer(ip)`, `real(dp)` (kinds bound to iso_c_binding types with compile-time checks)

## Example: High-Level API

```fortran
program my_app
    use libcint_fortran
    implicit none

    integer(ip) :: atm(LIBCINT_ATM_SLOTS, natm)
    integer(ip) :: bas(LIBCINT_BAS_SLOTS, nbas)
    real(dp) :: env(10000)
    real(dp), allocatable :: buf(:,:)
    integer(ip) :: shls(2), ret

    ! Setup system (atoms, basis sets, etc.)
    ! ...

    ! Compute overlap integral
    ret = libcint_1e_ovlp_sph(buf, shls, atm, natm, bas, nbas, env)
end program
```

See: `fortran_pure_example.F90`

## Example: Low-Level API

```fortran
program my_app
    use iso_c_binding
    use libcint_interface
    implicit none

    integer(c_int) :: atm(ATM_SLOTS, natm)
    integer(c_int) :: bas(BAS_SLOTS, nbas)
    real(c_double) :: env(10000)

    ! Direct C interop with explicit types
    ret = cint1e_ovlp_sph(buf, shls, atm, natm, bas, nbas, env)
end program
```

See: `fortran_modern_spheric.F90`, `fortran_modern_cartesian.F90`

## Building

The Fortran modules are compiled automatically when building libcint with `WITH_FORTRAN=ON` (default):

```bash
mkdir build && cd build
cmake ..
make

# Run examples
./examples/pure_fortran_f         # High-level API
./examples/modern_spheric_f       # Low-level API
./examples/time_c2h6_f            # Benchmark with OpenMP
./examples/time_c2h6_pure_f       # Benchmark with OpenMP using high-level API
```

The compiled module files (`.mod`) will be in `build/include/` and are installed with libcint.

## Available Examples

| Example | API Level | Description |
|---------|-----------|-------------|
| `fortran_pure_example.F90` | High-level | **Start here!** Clean Fortran code |
| `fortran_modern_cartesian.F90` | Low-level | Cartesian basis integrals |
| `fortran_modern_spheric.F90` | Low-level | Spherical harmonic integrals |
| `fortran_modern_spinor.F90` | Low-level | Relativistic spinor integrals |
| `fortran_time_c2h6.F90` | Low-level | Performance benchmark with OpenMP |
| `fortran_time_c2h6_pure.F90` | High-level | Performance benchmark with OpenMP using high-level API |
| `fortran_call_*.F90` | Legacy | Old-style |

## Using in Your Application

After installing libcint, simply use the modules:

```fortran
! CMakeLists.txt or build script needs:
! - Link to libcint: target_link_libraries(myapp cint)
! - Include module directory for .mod files

program myapp
    use libcint_fortran  ! High-level (recommended)
    ! or
    use libcint_interface  ! Low-level

    ! Your code here
end program
```

## Which API Should I Use?

- **New projects**: Use `libcint_fortran` (high-level) - cleaner code, same performance
- **Need control**: Use `libcint_interface` (low-level) - explicit C interop
- **Both**: You can mix them in the same program

## More Information

For detailed technical information, architecture diagrams, and advanced usage, see:
- **`Fortran_details.md`** - Complete technical documentation
- **libcint documentation**: https://github.com/sunqm/libcint

## Important Notes

Ô∏è **0-based indexing**: libcint uses 0-based indexing for atom and shell indices (Fortran arrays are still 1-based)

 **Array offsets**: Pointer offsets in `atm` and `bas` arrays are 0-based for C compatibility

See the examples and `Fortran_details.md` for more information.
